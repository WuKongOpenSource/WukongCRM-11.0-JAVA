(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4d8e"],{"3b8I":function(t,e,a){"use strict";var i=a("TftL");a.n(i).a},"4dIA":function(t,e,a){"use strict";var i=a("Flj7"),s={name:"TaskCell",components:{},mixins:[a("kK4T").a],props:{disabled:{type:Boolean,default:!1},data:Object,dataIndex:Number,dataSection:Number},data:function(){return{}},mounted:function(){},methods:{taskOverClick:function(t){Object(i.n)({taskId:t.taskId,status:t.checked?5:1}).then(function(t){}).catch(function(){t.checked=!1})},rowFun:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex,section:this.dataSection}})}}},n=(a("Lh9T"),a("KHd+")),l=Object(n.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":t.getPriorityColor(t.data.priority).color},on:{click:function(e){t.rowFun(t.data)}}},[a("div",{ref:"listLeft",staticClass:"list-left"},[a("div",{class:t.data.checked?"title title-active":"title",on:{click:function(t){t.stopPropagation()}}},[a("el-checkbox",{attrs:{disabled:t.disabled},on:{change:function(e){t.taskOverClick(t.data)}},model:{value:t.data.checked,callback:function(e){t.$set(t.data,"checked",e)},expression:"data.checked"}})],1),t._v(" "),a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.data.name))])]),t._v(" "),a("span",{ref:"itemSpan",class:t.data.checked?"item-name-active":"item-name"},[t._v("\n        "+t._s(t.data.name)+"\n      ")])])],1),t._v(" "),a("div",{staticClass:"list-right"},[t.data.labelList?a("div",{staticClass:"tag-box"},[t.data.labelList.length<=2?t._l(t.data.labelList,function(e,i){return a("div",{key:i,staticClass:"item-label"},[a("span",{staticClass:"k-name",style:{background:e.color}},[t._v(t._s(e.labelName))])])}):[a("span",{staticClass:"k-name",style:{background:t.data.labelList[0].color}},[t._v(t._s(t.data.labelList[0].labelName))]),t._v(" "),a("span",{staticClass:"k-name",style:{background:t.data.labelList[1].color}},[t._v(t._s(t.data.labelList[1].labelName))]),t._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[a("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},t._l(t.data.labelList,function(e,i){return a("div",{key:i,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[i>=2?a("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:e.color?e.color:"#ccc"}},[t._v(t._s(e.labelName))]):t._e()])})),t._v(" "),a("span",{staticClass:"color-label-more"},[a("i",[t._v("...")])])])]],2):t._e(),t._v(" "),a("div",{staticClass:"img-group"},[t.data.relationCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),a("span",[t._v(t._s(t.data.relationCount))])]):t._e(),t._v(" "),t.data.childAllCount>0?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),a("span",[t._v(t._s(t.data.childWCCount)+"/"+t._s(t.data.childAllCount))])]):t._e(),t._v(" "),t.data.fileCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-file"}),t._v(" "),a("span",[t._v(t._s(t.data.fileCount))])]):t._e(),t._v(" "),t.data.commentCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),a("span",[t._v(t._s(t.data.commentCount))])]):t._e(),t._v(" "),t.data.stopTime?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-time-task",style:{color:1!=t.data.isEnd||t.data.checked?"#999":"red"}}),t._v(" "),a("span",{style:{color:1!=t.data.isEnd||t.data.checked?"#999":"red"}},[t._v(t._s(t._f("moment")(t.data.stopTime,"MM-DD"))+" 截止")])]):t._e()]),t._v(" "),a("div",{staticClass:"item-own-box"},[t.data.mainUser&&t.data.mainUser.id?a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.data.mainUser.realname))])]),t._v(" "),a("xr-avatar",{staticClass:"user-img",attrs:{name:t.data.mainUser.realname,size:24,src:t.data.mainUser.img}})],1):t._e()],1)])])},[],!1,null,"b6d94c68",null);l.options.__file="TaskCell.vue";e.a=l.exports},"9GgJ":function(t,e,a){"use strict";var i={name:"XrHeader",components:{},props:{iconClass:[String,Array],iconColor:String,label:String,showSearch:{type:Boolean,default:!1},searchIconType:{type:String,default:"text"},placeholder:{type:String,default:"请输入内容"},ftTop:{type:String,default:"15px"},content:[String,Number],inputAttr:{type:Object,default:function(){}}},data:function(){return{search:""}},computed:{},watch:{content:{handler:function(){this.search!=this.content&&(this.search=this.content)},immediate:!0}},mounted:function(){},beforeDestroy:function(){},methods:{inputChange:function(){this.$emit("update:content",this.search)},searchClick:function(){this.$emit("search",this.search)}}},s=(a("zIzm"),a("KHd+")),n=Object(s.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("flexbox",{staticClass:"xr-header"},[t.iconClass?a("div",{staticClass:"xr-header__icon",style:{backgroundColor:t.iconColor}},[a("i",{class:t.iconClass})]):t._e(),t._v(" "),a("div",{staticClass:"xr-header__label"},[t.$slots.label?t._t("label"):[t._v(t._s(t.label))]],2),t._v(" "),t.showSearch?a("el-input",t._b({staticClass:"xr-header__search",class:{"is-text":"text"===t.searchIconType},style:{"margin-top":t.ftTop},attrs:{placeholder:t.placeholder},on:{input:t.inputChange},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.searchClick(e):null}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},"el-input",t.inputAttr,!1),["text"===t.searchIconType?a("el-button",{attrs:{slot:"append",type:"primary"},nativeOn:{click:function(e){return t.searchClick(e)}},slot:"append"},[t._v("搜索")]):a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},nativeOn:{click:function(e){return t.searchClick(e)}},slot:"append"})],1):t._e(),t._v(" "),a("div",{staticClass:"xr-header__ft",style:{top:t.ftTop}},[t._t("ft")],2)],1)},[],!1,null,"7bba770c",null);n.options.__file="index.vue";e.a=n.exports},"9Zm0":function(t,e,a){},Lh9T:function(t,e,a){"use strict";var i=a("9Zm0");a.n(i).a},TftL:function(t,e,a){},ihDC:function(t,e,a){},jcXo:function(t,e,a){"use strict";a.r(e);var i=a("FyfS"),s=a.n(i),n=a("2X1c"),l=a("4dIA"),o=a("pKm3"),c=a("9GgJ"),r={components:{TaskDetail:o.a,TaskCell:l.a,XrHeader:c.a},data:function(){return{loading:!0,list:[],taskID:"",detailIndex:-1,taskDetailShow:!1}},created:function(){this.getList()},mounted:function(){document.getElementById("project-container").addEventListener("click",this.taskShowHandle,!1)},methods:{getList:function(){var t=this;Object(n.b)().then(function(e){t.list=e.data;var a=!0,i=!1,n=void 0;try{for(var l,o=s()(t.list);!(a=(l=o.next()).done);a=!0){var c=l.value;c.isDeleted=!0,5==c.status&&(c.checked=!0)}}catch(t){i=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw n}}t.loading=!1}).catch(function(){t.loading=!0})},taskCellHandle:function(t){if("view"==t.type){var e=t.data;this.taskID=e.item.taskId,this.detailIndex=e.index,this.taskDetailShow=!0}},detailHandle:function(t){if(0==t.index||t.index)if("title-check"==t.type)this.$set(this.list[t.index],"checked",t.value);else if("delete"==t.type||"activate-task"==t.type||"recover-task"==t.type||"thorough-delete-task"==t.type)this.list.splice(t.index,1);else if("change-stop-time"==t.type){new Date(t.value).getTime()/1e3+86399>(new Date).getTime()/1e3?this.list[t.index].isEnd=!1:this.list[t.index].isEnd=!0,this.list[t.index].stopTime=t.value}else if("change-priority"==t.type)this.list[t.index].priority=t.value.id;else if("change-name"==t.type)this.list[t.index].name=t.value;else if("change-comments"==t.type){var e=this.list[t.index].commentCount;"add"==t.value?this.list[t.index].commentCount=e+1:this.list[t.index].commentCount=e-1}else"change-sub-task"==t.type?(this.list[t.index].childWCCount=t.value.subdonecount,this.list[t.index].childAllCount=t.value.allcount):"change-main-user"==t.type?this.list[t.index].mainUser=t.value:"change-label"==t.type&&(this.list[t.index].labelList=t.value)},closeBtn:function(){this.taskDetailShow=!1},taskShowHandle:function(t){if(this.$refs.particulars&&!this.$refs.particulars.$el.contains(t.target)){for(var e=!0,a=document.getElementsByClassName("item-list"),i=0;i<a.length;i++){if(a[i].contains(t.target)){e=!1;break}}this.taskDetailShow=!e}}}},d=(a("3b8I"),a("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"recycle"},[a("xr-header",{attrs:{"icon-class":"wk wk-icon-bin","icon-color":"#fd5b4a",label:"回收站"}}),t._v(" "),a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length&&!t.loading,expression:"list.length === 0 && !loading"}],staticClass:"content"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"task-cells"},t._l(t.list,function(e,i){return a("task-cell",{key:i,staticClass:"item-list",attrs:{data:e,"data-index":i,disabled:""},on:{"on-handle":t.taskCellHandle}})}))]),t._v(" "),t.taskDetailShow?a("task-detail",{ref:"particulars",attrs:{id:t.taskID,"detail-index":t.detailIndex,"is-trash":""},on:{"on-handle":t.detailHandle,close:t.closeBtn}}):t._e()],1)},[],!1,null,"7144c388",null);u.options.__file="index.vue";e.default=u.exports},zIzm:function(t,e,a){"use strict";var i=a("ihDC");a.n(i).a}}]);